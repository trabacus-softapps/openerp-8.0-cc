<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record model="ir.ui.view" id="cctra_kanban_view_leads">
            <field name="name">cctra_kanban_view_leads</field>
            <field name="model">crm.lead</field>
            <field name="arch" type="xml">
                <kanban>
                    <field name="state" groups="base.group_no_one"/>
                    <field name="stage_id"/>
                    <field name="color"/>
                    <field name="priority"/>
                    <field name="planned_revenue" sum="Expected Revenues"/>
                    <field name="user_email"/>
                    <field name="user_id"/>
                    <field name="partner_address_email"/>
                    <field name="message_summary"/>
                    <field name="message_unread"/>
                    <templates>
                        <field name="date_deadline"/>
                        <t t-name="kanban-box">
                            <div
                                t-attf-class="oe_kanban_color_#{kanban_getcolor(record.color.raw_value)} oe_kanban_card oe_kanban_global_click">
                                <div class="oe_dropdown_toggle oe_dropdown_kanban">
                                    <span class="oe_e">Ã­</span>
                                    <ul class="oe_dropdown_menu">
                                        <t t-if="widget.view.is_action_enabled('edit')">
                                            <li>
                                                <a type="edit">Edit...</a>
                                            </li>
                                        </t>
                                        <t t-if="widget.view.is_action_enabled('delete')">
                                            <li>
                                                <a type="delete">Delete</a>
                                            </li>
                                        </t>
                                        <li>
                                            <a name="%(mail.action_email_compose_message_wizard)d"
                                                type="action">Send Email</a>
                                        </li>
                                        <li>
                                            <a name="%(crm.opportunity2phonecall_act)d"
                                                type="action">Schedule/Log Call</a>
                                        </li>
                                        <li>
                                            <a name="action_makeMeeting" type="object">Schedule
                                                Meeting</a>
                                        </li>
                                        <li>
                                            <ul class="oe_kanban_colorpicker" data-field="color"/>
                                        </li>
                                    </ul>
                                </div>
                                <div class="oe_kanban_content">
                                    <div>
                                        <b>
                                            <field name="name"/>
                                        </b>
                                        <t t-if="record.planned_revenue.raw_value"> - <b><t
                                                  t-esc="record.planned_revenue.value"/>
                                                <field name="company_currency"/></b>
                                        </t>
                                    </div>
                                    <div>
                                        <field name="partner_id"/>
                                    </div>
                                    <div style="padding-left: 0.5em">
                                        <t
                                            t-if="record.date_deadline.raw_value and record.date_deadline.raw_value lt (new Date())"
                                            t-set="red">oe_kanban_text_red</t>
                                        <span t-attf-class="#{red || ''}">
                                            <field name="date_action"/>
                                        </span>
                                        <t t-if="record.date_action.raw_value"> : </t>
                                        <field name="title_action"/>
                                    </div>
                                    <div class="oe_kanban_bottom_right">
                                        <a t-if="record.priority.raw_value == 1" type="object"
                                            name="set_normal_priority" class="oe_e oe_star_on">7</a>
                                        <a t-if="record.priority.raw_value != 1" type="object"
                                            name="set_high_priority" class="oe_e oe_star_off">7</a>
                                        <img
                                            t-att-src="kanban_image('res.users', 'image_small', record.user_id.raw_value)"
                                            t-att-title="record.user_id.value" width="24"
                                            height="24" class="oe_kanban_avatar"
                                            t-if="record.user_id.value"/>
                                    </div>
                                    <div class="oe_kanban_footer_left">
                                        <t t-raw="record.message_summary.raw_value"/>
                                    </div>
                                </div>
                                <div class="oe_clear"/>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>


<!--  ===================================================  
	    Overridden: Leads Search View
      =================================================== -->
        <record id="view_cclead_filter" model="ir.ui.view">
            <field name="name">view_cclead_filter</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.view_crm_case_opportunities_filter"/>
            <field name="arch" type="xml">
                <filter string="Won" name="won"  position="before">
                    <filter icon="terp-go-today" string="Today"
                        domain="[('date_action','=', time.strftime('%%Y-%%m-%%d'))]"
                        name="today"
                    />  
                    <filter icon="terp-go-today" string="Current"
                        domain="[('date_requested','>=', time.strftime('%%Y-%%m-%%d 00:00')),('state','!=','cancel')]"
                        name="booking"
                    /> 
                </filter>
                <xpath expr="//search[@string='Search Opportunities']" position="inside">
                    <field name="lead_no"/>
                </xpath>
                <xpath expr="//search[@string='Search Opportunities']/field[@name='categ_ids']" position="after">
                    <field name="restaurant_id"/> 
                    <field name="date_action"/>
                </xpath>
                
            </field>
        </record>

        <!--  =================================================== 
	    Overridden: Leads Tree View
      ===================================================
-->

        <record model="ir.ui.view" id="crm.crm_case_tree_view_oppor">
            <field name="name">Leads Tree</field>
            <field name="model">crm.lead</field>
            <field name="arch" type="xml">
                <tree string="Opportunities" fonts="bold:message_unread==True;bold:state=='draft'"
                      colors="blue:state == 'draft';gray:state in ('cancel', 'done');red:date_deadline and (date_deadline &lt; current_date)">
                    <field name="date_deadline" invisible="1"/>
                    <field name="create_date"/>
                    <field name="lead_no"/>
                    <field name="name"/>
                    <field name="user_id"/>
                    <field name="partner_id"/>
                    <field name="restaurant_id"/>
                    <field name="date_requested"/>
                    <field name="covers"/>
                    <field name='is_servccharge'/>
                    <field name="date_action"/>
                    <field name="cust_ref"/>
                    <field name="notes"/>
                    <field name="stage_id"/>
                    <field name="section_id" invisible="context.get('invisible_section', True)"/>
                    <field name="type_id" invisible="1"/>
                    <field name="message_unread" invisible="1"/>
                    <field name="state" invisible="1"/>
                </tree>
            </field>
        </record>

        <!--  =================================================== 
	    Inherited: Leads Form View
      ===================================================
-->

        <record id="view_cclead_form" model="ir.ui.view">
            <field name="name">view_cclead_form</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
            <field name="arch" type="xml">

                <xpath expr="//header/button[@string='Mark Won']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//header/button[@string='Mark Lost']" position="attributes">
                    <attribute name="groups"
                        >Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo</attribute>
                </xpath>

                <xpath expr="//header/button[@string='Mark Lost']" position="before">
                    <button name="%(mail.action_email_compose_message_wizard)d" string="Send Info"
                            class="oe_highlight" type="action"
                            attrs="{'invisible':[('service_type','=','noontea')]}"
                            groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo"/>
                    <button name="send_request_avail" string="Reqt. Availability"
                            class="oe_highlight" type="object"
                            groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo"/>
                    <!-- <button name="button_dummy" string="Compute" class="oe_highlight" type="object" groups='Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo'/> -->
                  <!--   <button name="Send_mesg_BOuser" string="Remainder" class="oe_highlight" type="object"/> -->               	 
                </xpath>

                <xpath expr="//div[2]/h2" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//header/field[@name='stage_id']" position="replace">
                    <field name="stage_id" widget="statusbar" clickable="True"
                           domain="['&amp;', '|', ('case_default', '=', True), ('section_ids', '=', section_id), '|', ('type', '=',service_type), ('type', '=', 'both')]"
                           on_change="onchange_stage_id(stage_id)"
                           groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo" />
                </xpath>

                <field name="name" position="after">
                    <field name="lead_no" readonly="1"/>
                </field>

                <field name="partner_id" position="attributes">
                    <attribute name="required">1</attribute>
                    <attribute name="domain">[]</attribute>
                    <attribute name="attrs">{'readonly':[('usr_role','=','client')]}</attribute>
                    <attribute name="context"
                        >{'default_partner_type':'client','show_address':1}</attribute>
                    <attribute name="options">{"always_reload": True}</attribute>
                </field>

                <xpath expr="//div[1]" position="replace"/>
                <field name="email_from" string="Email" position="replace"/>
                <field name="phone" position="replace">
                    <field name="service_type" invisible="1"/>
                    <field name="passen_type" invisible="1"/>
                </field>

                <xpath expr="//group[1]/group[3]" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//group[1]/group[4]" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <field name="user_id" on_change="on_change_user(user_id, context)"
                       position="replace"/>
                <xpath expr="//group[1]/group[2]" position="replace">
                    <group>
                        <field name="cust_ref"  required="1"/>
                        <label for="title_action"
                               groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo"/>
                        <div groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo">
                            <field name="date_action" nolabel="1"/>
                            <label string="-"
                                   attrs="{'invisible': ['|', ('date_action', '=', False), ('title_action', '=', False)]}"/>
                            <field name="title_action" class="oe_inline" nolabel="1"
                                   placeholder="e.g. Call for proposal"/>
                        </div>
                        <field name="date_requested" on_change="onchange_DOB(date_requested)"
                               required="1"/>
                        <field name="conv_dob" invisible="1"/>
                        <field name="conv_tob" invisible="1"/>
                        <field name="user_id" on_change="on_change_user(user_id, context)"
                               groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo"
                               attrs="{'required':[('usr_role','in',['admin','bo'])]}"/>
                    </group>
                </xpath>

                <xpath expr="//notebook/page[@string='Internal Notes']" position="attributes">
                    <attribute name="string">Requirements</attribute>
                </xpath>

                <xpath expr="//group[1]/group[3]" position="before">
                    <group col="4" colspan="2">
                        <group col="2" colspan="2">
                            <field name="usr_role" invisible="1"/>
                            <label for="covers"/>
                            <div>
                                <field name="covers" required="1" class="oe_inline" attrs="{'readonly':[('state','not in',['draft','pending'])]}"/>
                                <button name="compute_all" states="draft,pending" string="(update)"
                                        type="object" class="oe_edit_only oe_link"/>
                            </div>
                            <field name="alt_date"
                                   attrs="{'invisible':[('service_type','=','venue')]}"/>
                            <field name="restrt_name"/>
                            <field name="dining_room"/>
                            <field name="business_type"
                                   attrs="{'invisible':[('service_type','=','noontea')]}"/>                            
                            <field name="hire_required"
                                attrs="{'invisible':[('service_type','=','noontea')]}"/>
                        </group>
                        <group col="2" colspan="2">
                            <field name='foc'/>
                            <field name="event_type"/>
                            <field name="area" invisible="1"/>
                            <field name="alt_hotel"
                                   attrs="{'invisible':[('service_type','=','venue')]}"/>
                            <field name="budget"/>
                            <field name="reason_event"
                                   attrs="{'invisible':[('service_type','=','venue')]}"/>
                            <field name="cuisine"
                                   attrs="{'invisible':[('service_type','=','noontea')]}"/>
                            <field name="sales_person"
                                attrs="{'invisible':[('service_type','=','noontea')],'required':[('service_type','=','venue')]}"/>
                            <field name="lead_day"/>
                            <field name="lead_res_type"/>
                        </group>                        
                        <field name="notes" colspan="4"/>
                    </group>
                </xpath>
                <xpath expr="//page[2]" position="attributes">
                    <attribute name="groups"
                        >Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo</attribute>
                </xpath>
                <xpath expr="//page[2]/group[1]/group[5]" position="replace"/>
                <xpath expr="//page[2]/group[1]/group[4]" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//page[2]/group[1]/group[3]" position="replace"/>

                <xpath expr="//page[2]/group[1]/group[1]/div[1]" position="after">
                    <button string="Create As Contact" name="create_contacts" type="object"
                            attrs="{'invisible':[('partner_id','!=',False)]}"/>
                </xpath>

                <xpath expr="//page[@string='Lead']" position="attributes">
                    <attribute name="string">Enquiry</attribute>
                </xpath>

                <label for="planned_revenue" position="replace"/>

                <field name="function" position="replace">
                    <field name="phone"/>
                    <field name="state" invisible="1"/>
                </field>

                <field name="fax" position="before">
                    <field name="email_from" string="Email"/>
                </field>
                <field name="phone" position="before">
                    <field name="booker_name" string="Booker Name"/>
                </field>

                <xpath expr="//page[1]" position="before">
                    <page string="Send Information"
                          groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo">
                        <field name="info_ids" mode="tree"
                            context="{'service_type': service_type,'covers':covers,'default_foc':foc,'default_group_name':cust_ref,'curr_state':state}">
                            <tree string="Send Information" version="7.0">
                                <field name="availability" string="" invisible="1"/>
                                <field name="restaurant_id"/>
                                <field name="date_avail"/>
                                <field name="area"/>
                                <field name="tot_top_price" string="Tour Operator Price" sum="top"/>
                                <field name="tot_rest_price" string="Restaurant Price" sum="rest"/>
                            </tree>
                            <form string="Send Information" version="7.0">
                                <header>
                                    <button string="Send Mail"
                                            name="%(mail.action_email_compose_message_wizard)d"
                                            type="action" class="oe_highlight"/>
                                    <button name="cc_create_invoices" string="Mark Completed"
                                            type="object" class="oe_highlight"
                                            attrs="{'invisible':[('state','in',['open','cancel','done'])]}"
                                            confirm="DO YOU WANT TO CONTINUE WITH THIS ACTION?"/>                                    
                                    <button string="Print TO Booking Confirmation"  name='print_voucher' type='object' class="oe_highlight" context="{'is_top':True,'is_rp':False}"/>
                                    <button string="Print Venue Confirmation"  name='print_voucher' type='object' class="oe_highlight"  context="{'is_rp':True,'is_top':False}"/>
                                    <button string="Change Covers"  name='update_invoice' 
                                            type='object' class="oe_highlight" 
                                            attrs="{'invisible':[('is_completed','=',False)]}" 
                                            confirm="THIS ACTION WILL CREATE INVOICE/CREDIT NOTE FOR CHANGE IN NO. OF COVERS"/>
                                    <!--                             	  	<button name="Send_mail_to_Restaurant" string="Reminder Mail" type="object" class="oe_highlight" confirm="DO YOU WANT TO CONTINUE WITH THIS ACTION?"/> -->
                                </header>
                                <field name="state" invisible="1"/>
                                <group col="4" colspan="2">
                                    <group col="2" colspan="2">
                                        <field name="bvrges_extra"/>
                                        <field name="request_sent" readonly="1" invisible="1"/>
                                        <field name="restaurant_id" required="1"
                                               on_change="onchange_restaurant_id(restaurant_id,parent.service_type)"
                                               context="{'default_partner_type':'venue','show_address':1}"
                                               options="{'always_reload': True,'limit': 1000}"
                                               domain="[('type','=','default')]"/>
                                        <field name="cont_address_id"
                                               context="{'default_partner_type':'contact','show_address':1}"
                                               options="{'always_reload': True}"
                                               domain="[('partner_type','=','contact'),('type','=','contact')]"/>
                                        <label for="invoice_type"/>
                                        <div>
                                            <field name="invoice_type" class="oe_inline"/>
                                            <button name="update_InvoiceType" string="(update)"
                                                    type="object" class="oe_edit_only oe_link"
                                                    attrs="{'invisible':[('state','in',['open','cancel','done'])]}"
                                            />
                                        </div>
                                        <field name="group_name"/>
                                        <field name="area"/>
                                        <field name="room_hire"/>
                                        <field name="drinks"/>
                                        <field name='is_completed' invisible="1"/>
                                    </group>
                                    <group col="2" colspan="2">
                                        <field name="availability" invisible="1"/>
                                        <field name="release_date"/>
                                        <field name="inv_address_id" required="1"
                                               context="{'default_partner_type':'venue','show_address':1}"
                                               options="{'always_reload': True}"
                                               domain="[('partner_type','=','venue'),('type','=','invoice')]"/>
                                        <field name="courses"/>
                                        <field name="foc"/>
                                        <field name="date_avail"/>
                                        <field name="place_cards"/>
                                        <field name="table_plan"/>
                                        <field name="set_up"/>
                                        <field name="rest_parent_id" invisible="1"/>
                                        <field name="product_id" invisible="1"/>
                                    </group>                            
                                    <separator string="Special / Dietary Requirements" colspan="4"/> 
                                    <field name="spcl_req" colspan="4" nolabel="1"/>
                                </group>
                                <group col="4" colspan="2">
                                    <separator string="Pricing"/>
                                    <newline/>
                                    <field name="tax_srvc_chrg"/>
                                    <field name="srvc_chrg_sup"/>
                                    <field name="tot_rest_price" invisible="1"/>
                                    <field name="tot_top_price" invisible="1"/>
                                </group>

                                <field name="menu_dt_ids" mode="tree"
                                    context="{'default_no_of_covers':covers,'ld_state': context.get('curr_state'),'default_invoice_type':invoice_type,'rest_id':restaurant_id,}">


                                    <tree string="Menu Details &amp; Pricing" version="7.0">
                                        <field name="menu_id" string="Menu" />
                                        <field name="no_of_covers"/>
                                        <field name="top_tot_top_price" string="Tour Operator Price"
                                               sum="top"/>
                                        <field name="rp_tot_rest_price" string="Restaurant Price"
                                               sum="rest"/>
                                    </tree>

                                    <form string="Menu Details &amp; Pricing" version="7.0">
                                        <group col="4" colspan="2">
                                            <field name="food_type" required="1"/>
                                            <field name="menu_id" on_change="onchange_menu_option(menu_id,menu_option,no_of_covers, parent.is_completed,invoice_type,context)"                                              
                                                domain="[('partner_id','in',[parent.inv_address_id,parent.restaurant_id]),('food_type','=',food_type)]" context="{'food_type':food_type}"/>
                                            <field name="menu_option" attrs="{'invisible':['|',('menu_id','=',False),('food_type','=','drink')]}"
                                                on_change="onchange_menu_option(menu_id,menu_option,no_of_covers, parent.is_completed,invoice_type)"/>
                                            <field name="no_of_covers"
                                                on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                            <field name="sc_included" on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)" />
                                            <field name='foc'/> 
                                            <separator colspan="4" style="color: red;font-size: 13px;font-style: italic;font-weight:lighter;" string="Note: If the above checkbox is checked, it implies that the service charge is already included in the menu price (field A). In this case, no additional service charge will be calculated in fields B &amp; 3. If the checkbox is unchecked, it means the menu price does not include a service charge. Hence, the system will calculate the same in field B &amp; 3 using the percentage specified in Service Charge % field."/>
                                            <separator string="Menu Details" colspan="4"/>
                                            <field name="menu_desc" colspan="4" nolabel="1"/>
                                            <field name="invoice_type" invisible="1"/>
                                            <field name="previous_covers" invisible='1'/>
                                        </group>
                                        <group col="4" colspan="2">
                                            <group col="2" colspan="2">
                                                <separator string="Restaurant Price"/>
                                                <hr width="100%%" colspan="2"/>
                                                <field name="rp_menu" attrs="{'readonly':[('food_type','=','drink')]}"
                                                    on_change="onchange_pricing('',no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="rp_sc_perc" 
                                                    on_change="onchange_pricing('rp_sc_perc', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="rp_service_charge" 
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="rp_drinks"
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="rp_additnal_srvc_chrg" attrs="{'readonly':[('food_type','=','drink')]}"
                                                    on_change="onchange_pricing('res_sc', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="rp_tot_price_pprsn"
                                                       class="add_bold_css"/>
                                                <field name="rp_tot_price" class="add_bold_css"/>
                                                <field name="rp_room_hire" attrs="{'readonly':[('food_type','=','drink')]}"
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="rp_others" attrs="{'readonly':[('food_type','=','drink')]}"
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="rp_tot_rest_price" class="add_bold_css"/>
                                                <separator string="Profit"/>
                                                <hr width="100%%" colspan="2"/>
                                                <field name="tot_profit" class="add_bold_css"
                                                       attrs="{'invisible':[('invoice_type','=','to_venue')]}"/>
                                                <field name="profit_on_comsion" class="add_bold_css"
                                                       attrs="{'invisible':[('invoice_type','=','to_client')]}"
                                                />
                                            </group>
                                            <group col="2" colspan="2">
                                                <separator string="Tour Operator Price"/>
                                                <hr width="100%%" colspan="2"/>
                                                <field name="top_mp_markup" 
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"
                                                       attrs="{'invisible':[('invoice_type','=','to_venue')],'readonly':[('food_type','=','drink')]}"/>
                                                <field name="top_menu_price" class="add_bold_css"/>
                                                <field name="top_sc_perc" 
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="top_service_charge" 
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="top_drinks_markup"
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"
                                                       attrs="{'invisible':[('invoice_type','=','to_venue')]}"/>
                                                <field name="top_drinks_price" class="add_bold_css"/>
                                                <field name="top_additnal_srvc_chrg" attrs="{'readonly':[('food_type','=','drink')]}"
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"/>
                                                <field name="top_tot_price_pprsn"
                                                       class="add_bold_css"/>
                                                <field name="comsion_pprsn_perc"
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"
                                                       attrs="{'invisible':[('invoice_type','=','to_client')],'readonly':[('food_type','=','drink')]}"/>
                                                <field name="comsion_pprsn"
                                                       on_change="onchange_cost('',no_of_covers, comsion_pprsn, comsion_rh)"
                                                       attrs="{'invisible':[('invoice_type','=','to_client')],'readonly':[('food_type','=','drink')]}"/>
                                                <field name="comsion_menu" class="add_bold_css"
                                                       attrs="{'invisible':[('invoice_type','=','to_client')]}"/>
                                                <field name="top_tot_price" class="add_bold_css"/>
                                                <field name="top_rh_markup"
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"
                                                       attrs="{'invisible':[('invoice_type','=','to_venue')],'readonly':[('food_type','=','drink')]}"/>
                                                <field name="top_room_hire_price"
                                                       class="add_bold_css"/>
                                                <field name="comsion_rh_perc"
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"
                                                       attrs="{'invisible':[('invoice_type','=','to_client')],'readonly':[('food_type','=','drink')]}"/>
                                                <field name="comsion_rh"
                                                       on_change="onchange_cost('',no_of_covers, comsion_pprsn, comsion_rh)"
                                                       attrs="{'invisible':[('invoice_type','=','to_client')],'readonly':[('food_type','=','drink')]}"/>
                                                <field name="top_others_markup"
                                                    on_change="onchange_pricing('', no_of_covers, parent.is_completed, rp_menu, rp_sc_perc, rp_drinks, rp_additnal_srvc_chrg, rp_room_hire, rp_others, top_mp_markup, top_sc_perc, top_drinks_markup, top_additnal_srvc_chrg, comsion_pprsn_perc, top_rh_markup, comsion_rh_perc, top_others_markup, food_type, sc_included)"
                                                       attrs="{'invisible':[('invoice_type','=','to_venue')],'readonly':[('food_type','=','drink')]}"/>
                                                <field name="top_others_price" class="add_bold_css"/>
                                                <field name="top_tot_top_price" class="add_bold_css"
                                                />
                                            </group>
                                        </group>
                                    </form>
                                </field>
                                <group col="4" colspan="2">
                                    <separator string="Notes-Restaurant" colspan="2"/>
                                    <separator string="Notes-Tour Operator"  colspan="2"/>
                                    <field name="rp_notes" nolabel="1" colspan="2"/>
                                    <field name="to_notes" nolabel="1" colspan="2"/>
                                    <separator string="Payment Term" colspan="4"/>
                                    <field name="payment_term" colspan="4" nolabel="1"/>
                                </group>
                            </form>
                        </field>
                    </page>
                    <page string="Reminder Time">
                        <field name="remind_ids" mode="tree"/>
                    </page>
                    <page string="Invoice">
                        <group col="4" colspan="4">
                            <field name="invoice_ids" nolabel='1' readonly='1' mode="tree">
                                <tree string="Invoice">
                                    <field name="partner_id"/>
                                    <field name="date_invoice"/>
                                    <field name="number"/>
                                    <field name="date_due"/>
                                    <field name="currency_id"/>
                                    <field name="residual" sum="Residual Amount"/>
                                    <field name="amount_untaxed" sum="Untaxed Amount"/>
                                    <field name="amount_total" sum="Total Amount"/>
                                    <field name="state"/>  
                                    <button name="button_myview" string="Open Invoice"	
                                        icon="STOCK_OPEN" type="object"/> 
                                </tree>
                            </field>
                        </group>                            
                    </page>
                </xpath>

            </field>
        </record>

        <!--  =================================================== 
	    Overriden: Afternoon Leads Form View
      ===================================================
-->

        <record model="ir.ui.view" id="crm_case_tree_view_aftn">
            <field name="name">Afternoon Tea - Leads Tree</field>
            <field name="model">crm.lead</field>
            <field name="arch" type="xml">
                <tree string="Opportunities" fonts="bold:message_unread==True;bold:state=='draft'"
                      colors="blue:state == 'draft';gray:state in ('cancel', 'done');red:date_deadline and (date_deadline &lt; current_date)">
                    <field name="date_deadline" invisible="1"/>
                    <field name="create_date"/>
                    <field name="lead_no"/>
                    <field name="name"/>
                    <field name="user_id"/>
                    <field name="partner_name"/>
                    <field name="restaurant_id"/>
                    <field name="date_requested"/>
                    <field name="covers"/>
                    <field name="date_action"/>
                    <field name="notes"/>
                    <field name="stage_id"/>
                    <field name="type_id" invisible="1"/>
                    <field name="message_unread" invisible="1"/>
                    <field name="state" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="view_cc_afternoon_lead_form" model="ir.ui.view">
            <field name="name">view_cc_afternoon_lead_form</field>
            <field name="model">crm.lead</field>
            <field eval="1" name="priority"/>
            <field name="arch" type="xml">
                <form string="Opportunities" version="7.0">
                    <header>
                        <button name="case_mark_lost" string="Mark Lost" type="object"
                                states="draft,open" class="oe_highlight"/>
                        <field name="stage_id" widget="statusbar" clickable="True"
                               domain="['&amp;', '|', ('case_default', '=', True), ('section_ids', '=', section_id), '|', ('type', '=',service_type), ('type', '=', 'both')]"
                               on_change="onchange_stage_id(stage_id)"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1>
                                <field name="name"/>
                                <field name="lead_no" readonly="1"/>
                            </h1>
                            <field name="service_type" invisible="1"/>
                            <field name="passen_type" invisible="1"/>
                            <field name="type" invisible="1"/>
                        </div>
                        <group>
                            <group>
                                <field name="partner_name" required="1"/>
                                <label for="street" string="Address"/>
                                <div>
                                    <field name="street" placeholder="Street..."/>
                                    <field name="street2"/>
                                    <div class="address_format">
                                        <field name="city" placeholder="City" style="width: 40%%"/>
                                        <field name="state_id" options='{"no_open": True}'
                                               on_change="onchange_state(state_id)"
                                               placeholder="County" style="width: 24%%"/>
                                        <field name="zip" placeholder="Post Code"
                                               style="width: 34%%"/>
                                    </div>
                                    <field name="country_id" placeholder="Country"
                                           options='{"no_open": True}'/>
                                </div>
                            </group>

                            <group>
                                <!-- <label for="contact_name"/>
                                    <div>
                                        <field name="contact_name" class="oe_inline"/>
                                        <field name="title" placeholder="Title" domain="[('domain', '=', 'contact')]" options='{"no_open": True}' class="oe_inline"/>
                                    </div> -->
                                <field name="function"/>
                                <field name="mobile"/>
                                <field name="email_from" string="Email"/>
                                <field name="phone"/>
                                <field name="fax"/>
                                <field name="cust_ref"/>
                            </group>
                            <group>
                                <field name="user_id" on_change="on_change_user(user_id, context)"
                                    required="1"/>
                                <field name="section_id" widget="selection" invisible="1"/>
                                <field name="covers" required="1" on_change="onchange_covers(covers,state)"/>
                                <field name="enquiry_covers"/>
                                <field name="alt_date"/>
                                <field name="restrt_name"/>
                                <field name="dining_room"/>
                                <field name="reason_event"/>
                                <field name="prev_covers" invisible="1"/>
                            </group>
                            <group>
                                <label for="title_action"/>
                                <div>
                                    <field name="date_action" nolabel="1"/>
                                    <label string="-"
                                           attrs="{'invisible': ['|', ('date_action', '=', False), ('title_action', '=', False)]}"/>
                                    <field name="title_action" class="oe_inline" nolabel="1"
                                           placeholder="e.g. Call for proposal"/>
                                </div>
                                <field name="date_requested"
                                       on_change="onchange_DOB(date_requested)" required="1"/>
                                <field name="conv_dob" invisible="1"/>
                                <field name="conv_tob" invisible="1"/>
                                <field name="event_type"/>
                                <field name="alt_hotel"/>
                                <field name="budget"/> 
                            </group>
                            <group col="4" colspan="4">
                            <field name="notes"/>
                            </group>
                        </group>
                        <field name="state" invisible="1"/>
                        <notebook colspan="4">
                            <page string="Send Information"
                                  groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo">
                                <field name="info_ids" mode="tree"
                                       context="{'service_type': service_type}">
                                    <tree string="Send Information" version="7.0">
                                        <field name="restaurant_id"/>
                                        <field name="set_up"/>
                                        <field name="hire_charge"/>
                                        <field name="noontea_comsion"/>
                                    </tree>
                                    <form string="Send Information" version="7.0">
                                        <header>
                                            <button string="Send Mail"
                                                    name="%(mail.action_email_compose_message_wizard)d"
                                                    type="action" class="oe_highlight"/>
                                            <button name="cc_create_invoices"
                                                    string="Mark Completed" type="object"
                                                    class="oe_highlight"
                                                    attrs="{'invisible':[('state','in',['open','cancel','done'])]}"
                                                    confirm="DO YOU WANT TO CONTINUE WITH THIS ACTION?"
                                            />
                                            <button string="Print Booking Confirmation"  name='print_voucher' type='object' class="oe_highlight"/>
                                            <button string="Change Covers"  name='update_invoice' type='object' class="oe_highlight" attrs="{'invisible':[('is_completed','=',False)]}" 
                                                    confirm="THIS ACTION WILL CREATE INVOICE/CREDIT NOTE FOR CHANGE IN NO. OF COVERS"/>
                                        </header>
                                        <field name="state" invisible="1"/>
                                        <group col="4" colspan="2">
                                            <group col="2" colspan="2">
                                                <field name="restaurant_id" required="1"
                                                       on_change="onchange_restaurant_id(restaurant_id, parent.service_type)"
                                                       context="{'default_partner_type':'venue','show_address':1}"
                                                       options="{'always_reload': True,'limit':1000}"
                                                       domain="[('type','=','default')]"/>
                                                <field name="cont_address_id"
                                                       context="{'default_partner_type':'contact','show_address':1}"
                                                       options="{'always_reload': True}"
                                                       domain="[('partner_type','=','contact'),('type','=','contact')]"/>
                                                <field name="invoice_type" invisible="1"/>
                                                <field name="hire_charge"/>
                                            </group>
                                            <group col="2" colspan="2">
                                                <field name="request_sent" readonly="1"/>
                                                <field name="inv_address_id" required="1"
                                                       context="{'default_partner_type':'venue','show_address':1}"
                                                       options="{'always_reload': True}"
                                                       domain="[('partner_type','=','venue'),('type','=','invoice')]"/>
                                                <field name="set_up"/>
                                                <field name="noontea_comsion"/>
                                                <field name="product_id" invisible="1"/>
                                                <field name="is_completed" invisible="1"/>
                                            </group>
                                        </group>
                                        <group col="4" colspan="2">
                                            <group col="2" colspan="2">
                                                <separator string="Menu Details" colspan="2"/>
                                                <field name="description" colspan="2" nolabel="1"/>
                                            </group>
                                            <group col="2" colspan="2">
                                                <separator string="Special Requirement" colspan="2"
                                                           invisible="not context.get('is_noontea',False)"/>
                                                <field name="special_requirement" colspan="2"
                                                       nolabel="1"
                                                       invisible="not context.get('is_noontea',False)"/>
                                            </group>
                                        </group>
                                    </form>
                                </field>
                            </page>
                            <page string="Reminder Time">
                                <field name="remind_ids" mode="tree"/>
                            </page>
                            <page string="Requirements">
                                <field name="description"/>
                            </page>                            
                            <page string="Invoice">
                                <group col="4" colspan="4">
                                    <field name="invoice_ids" nolabel='1' readonly='1' mode="tree">
                                        <tree string="Invoice">
                                            <field name="partner_id"/>
                                            <field name="date_invoice"/>
                                            <field name="number"/>
                                            <field name="date_due"/>
                                            <field name="currency_id"/>
                                            <field name="residual" sum="Residual Amount"/>
                                            <field name="amount_untaxed" sum="Untaxed Amount"/>
                                            <field name="amount_total" sum="Total Amount"/>
                                            <field name="state"/>  
                                            <button name="button_myview" string="Open Invoice"	
                                                icon="STOCK_OPEN" type="object"/> 
                                        </tree>
                                    </field>
                                </group>                            
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

<!--  ================= 
	  Group Bookings: Leads: Venues
      =================  
-->

        <record model="ir.actions.act_window" id="action_cclead_venue">
            <field name="name">Enquiries - Venue</field>
            <field name="res_model">crm.lead</field>
            <field name="view_mode">tree,graph,form,calendar</field>
            <field name="domain">[('type','=','opportunity'), ('service_type','=','venue'),('passen_type','=','group')]</field>
            <field name="context">{'search_default_booking':1,'stage_type': 'opportunity', 'default_type': 'opportunity',
                'default_user_id': uid,'default_service_type':'venue','service_type':'venue','default_passen_type':'group'}</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
            <field name="help" type="html">
                <field name="auto_refresh" eval="1"/>
                <p class="oe_view_nocontent_create"> Click to create a new Enquiry. </p>
            </field>
        </record>

        <record model="ir.actions.act_window.view" id="action_cclead_venue_tree">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="crm.crm_case_tree_view_oppor"/>
            <field name="act_window_id" ref="action_cclead_venue"/>
        </record>

        <record model="ir.actions.act_window.view" id="action_cclead_venue_form">
            <field name="sequence" eval="2"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="crm.crm_case_form_view_oppor"/>
            <field name="act_window_id" ref="action_cclead_venue"/>
        </record>


        <menuitem action="action_cclead_venue" id="menu_leads_venues" name="Venues"
                  parent="menu_cc_leads_group" sequence="1"
                  groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo"/>


<!--  ====================== 
	   Leads: Afternoon Tea
      ======================
-->
        <record model="ir.actions.act_window" id="action_cclead_ntea">
            <field name="name">Enquiries - Afternoon Tea</field>
            <field name="res_model">crm.lead</field>
            <field name="view_mode">tree,graph,form,calendar</field>
            <field name="domain">[('type','=','opportunity'),('service_type','=','noontea'),('passen_type','=','group')]</field>
            <field name="context">{'search_default_booking':1,'stage_type': 'opportunity', 'default_type': 'opportunity',
                'default_user_id': uid,'default_service_type':'noontea','is_noontea':1,'service_type':'noontea','default_passen_type':'group'}</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create"> Click to create a new Enquiry. </p>
            </field>
        </record>

        <record model="ir.actions.act_window.view" id="action_cclead_ntea_tree">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="crm_case_tree_view_aftn"/>
            <field name="act_window_id" ref="action_cclead_ntea"/>
        </record>

        <record model="ir.actions.act_window.view" id="action_cclead_ntea_form">
            <field name="sequence" eval="2"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_cc_afternoon_lead_form"/>
            <field name="act_window_id" ref="action_cclead_ntea"/>
        </record>
        <menuitem action="action_cclead_ntea" id="menu_leads_noontea" name="Afternoon Tea"
                  parent="menu_cc_leads_group" sequence="2"
                  groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo"/>
        
        
<!--  ================= 
	  FIT Bookings: Leads: Venues
      =================  
-->
        
        <record model="ir.actions.act_window" id="action_cclead_venue_fit">
            <field name="name">Enquiries - Venue</field>
            <field name="res_model">crm.lead</field>
            <field name="view_mode">tree,graph,form,calendar</field>
            <field name="domain">[('type','=','opportunity'), ('service_type','=','venue'),('passen_type','=','fit')]</field>
            <field name="context">{'search_default_booking':1,'stage_type': 'opportunity', 'default_type': 'opportunity',
                'default_user_id': uid,'default_passen_type':'fit',
                'default_service_type':'venue','service_type':'venue'}</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
            <field name="help" type="html">
                <field name="auto_refresh" eval="1"/>
                <p class="oe_view_nocontent_create"> Click to create a new Enquiry. </p>
            </field>
        </record>
        
        <record model="ir.actions.act_window.view" id="action_cclead_venue_fit_tree">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="crm.crm_case_tree_view_oppor"/>
            <field name="act_window_id" ref="action_cclead_venue_fit"/>
        </record>
        
        <record model="ir.actions.act_window.view" id="action_cclead_venue_form_fit">
            <field name="sequence" eval="2"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="crm.crm_case_form_view_oppor"/>
            <field name="act_window_id" ref="action_cclead_venue_fit"/>
        </record>
        
        <menuitem action="action_cclead_venue_fit" id="menu_leads_venues_fit" name="Venues"
            parent="menu_cc_leads_fit" sequence="1"
            groups="Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo"/>
        

<!--  ================= 
	   Portal: Venues
      =================  
-->

        <record model="ir.actions.act_window" id="action_cclead_venue_portal">
            <field name="name">Enquiries - Venue</field>
            <field name="res_model">crm.lead</field>
            <field name="view_mode">tree,graph,form,calendar</field>
            <field name="domain">[('type','=','opportunity'), ('service_type','=','venue')]</field>
            <field name="context">{'stage_type': 'opportunity', 'default_type':
                'opportunity','default_service_type':'venue','default_date_action':time.strftime('%Y-%m-%d')}</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create"> Click to create a new Enquiry. </p>
            </field>
        </record>

        <record model="ir.actions.act_window.view" id="action_cclead_venue_portal_tree">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="crm.crm_case_tree_view_oppor"/>
            <field name="act_window_id" ref="action_cclead_venue_portal"/>
        </record>

        <record model="ir.actions.act_window.view" id="action_cclead_venue_portal_form">
            <field name="sequence" eval="2"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="crm.crm_case_form_view_oppor"/>
            <field name="act_window_id" ref="action_cclead_venue_portal"/>
        </record>

        <menuitem action="action_cclead_venue_portal" id="menu_leads_portal_venues" name="Venues"
                  parent="menu_cc_portal_enquiries" sequence="1"
                  groups="Trabacus_Capitalcentric.cc_client"/>

    </data>
</openerp>

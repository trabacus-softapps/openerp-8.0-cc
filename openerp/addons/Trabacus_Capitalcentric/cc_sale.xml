<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
    	
    	<record id="view_ccsale_order_tree" model="ir.ui.view">
	            <field name="name">view_ccsale_order_tree</field>
	            <field name="model">sale.order</field>
	            <field name="inherit_id" ref="sale.view_order_tree"/>
	            <field name="arch" type="xml">
    			<tree string="Sales Orders" position='attributes'>
    				<attribute name="create">false</attribute>
    			</tree>
    			</field>
    	</record>
    			
    	<record id="view_ccsale_order_form" model="ir.ui.view">
	            <field name="name">view_ccsale_order_form</field>
	            <field name="model">sale.order</field>
	            <field name="inherit_id" ref="sale.view_order_form"/>
	            <field name="arch" type="xml">
	            
	            <xpath expr="//notebook/page/field/tree/field[@name='price_unit']" position="after">
	            	<field name='markup'/>
	            	<field name='commission'/>
                </xpath>
                
                <button name="%(sale.action_view_sale_advance_payment_inv)d" string="Create Invoice"
                        type="action" states="manual" class="oe_highlight" groups="base.group_user" position='replace'>
                        
                        <button name="Provisional_booking" string="Provisional Booking"
				                type="object" states="draft,sent" class="oe_highlight"/>    
						<button name="cc_create_invoices" string="Mark Completed"
				                type="object" states="progress" class="oe_highlight"/> 
                </button>   
                
                <button name="action_button_confirm" string="Confirm Sale" position='attributes'>
                	<attribute name="states">provisional</attribute>
                	<attribute name="string">Mark Confirmed</attribute>
                	<attribute name="class">oe_highlight</attribute>
                </button>
                
                <button name="action_button_confirm" states="sent" string="Confirm Sale" class="oe_highlight" position='attributes'>
                	<attribute name="invisible">1</attribute>
                </button>  
                
                 <button name="action_quotation_send" string="Send by Email" type="object" states="draft" class="oe_highlight" groups="base.group_user" position='replace'/>
                 <button name="action_quotation_send" string="Send by Email" type="object" states="sent" groups="base.group_user" position='replace'/>
                                       
                <field name='shop_id' position='attributes'>
                	<attribute name="invisible">1</attribute>
                </field>
                            
                <field name='client_order_ref' position='replace'>
                	<field name='cc_datetime'/>
                	<field name='release_date'/>
                	<field name='group_name' />
                	<field name='invoice_type' required='1'/>
                	<field name='service_type' invisible='1'/>
                	<field name='lead_id' readonly='1'/>
                </field>
                
                <field name="order_line" position='replace'>
                	<field name="order_line">
                                <form string="Sales Order Lines" version="7.0">
                                    <header groups="base.group_user" invisible='1'>
                                        <button name="%(sale.action_view_sale_order_line_make_invoice)d" states="confirmed" string="Invoice" type="action" icon="terp-document-new"/>
                                        <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,done" statusbar_colors='{"exception":"red","cancel":"red"}'/>
                                    </header>
                                    <group>
                                        <group>
                                            <field name="state" invisible="1" />
                                            <field name="product_id"
                                                context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}"
                                                invisible='1' groups="base.group_user"
                                                on_change="product_id_change(parent.pricelist_id, product_id, product_uom_qty, product_uom, 0.000, False, name, parent.partner_id, False, True, parent.date_order, False, parent.fiscal_position, False, context)"/>
                                            <field name='restaurant_id' readonly='1'/>
                                            <field name='room_hire'/> 
											<field name='drinks'/>   
											<field name='courses'/>                                                                                     
                                            <label for="product_uom_qty" string='Covers'/>
                                            <div>
                                                <field
                                                    context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}"
                                                    name="product_uom_qty" class="oe_inline"
                                                    on_change="get_subtotal(product_uom_qty, price_unit, markup, service_charge)"/>
                                                <field name="product_uom" groups="product.group_uom" class="oe_inline oe_no_button"/>
                                            </div>
                                            <field name="price_unit" on_change="get_subtotal(product_uom_qty, price_unit, markup, service_charge)" string='Restaurant Price'/>
                                        	<field name='markup'     on_change="get_subtotal(product_uom_qty, price_unit, markup, service_charge)"/>
                                        	<field name='tax_srvc_chrg'/> 
                                        	<field name='sc_included'/>
                                        </group>
                                        <group>
                                        	<field name='menu_mapping' invisible='1'/>
                                        	<field name='menu_id' on_change="onchange_menu(menu_id, product_uom_qty)"/>
                                        	<field name='set_up'/> 
											<field name='place_cards'/>
											<field name='table_plan'/>
                                        	<field name='commission'/>
                                        	<field name='service_charge' on_change="get_subtotal(product_uom_qty, price_unit, markup, service_charge)"/>
                                        	<field name='price_subtotal' string='Tour Operator Price'/>
                                            <field name="tax_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','&lt;&gt;','purchase')]"/>
                                            <field name="type" invisible='1'/>
                                            <field name="th_weight" invisible='1'/>
                                            <!-- we should put a config wizard for these two fields -->
                                            <field name="address_allotment_id" invisible='1'/>
                                        </group>
                                    </group>
                                    <label for="name"/>
                                    <field name="name"/>
                                    <div groups="base.group_no_one" invisible='1'>
                                        <label for="invoice_lines"/>
                                        <field name="invoice_lines"/>
                                    </div>
                                </form>
                                <tree string="Sales Order Lines">
                                    <field name="sequence" widget="handle"/>
                                    <field name="state" invisible="1"/>
                                    <field name="product_id"
                                        context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}"
                                        invisible='1' groups="base.group_user" 
                                        on_change="product_id_change(parent.pricelist_id, product_id, product_uom_qty, product_uom, 0.000, False, name, parent.partner_id, False, True, parent.date_order, False, parent.fiscal_position, False, context)"/>
                                    <field name="name" invisible='1'/>
                                    <field name='restaurant_id'/>
                                    <field name='menu_id'/>
                                    <field name="product_uom_qty" string='Covers'
                                        context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}"
                                        on_change="product_id_change(parent.pricelist_id, product_id, product_uom_qty, product_uom, 0.000, False, name, parent.partner_id, False, False, parent.date_order, False, parent.fiscal_position, True, context)"/>
                                    <field name="product_uom" groups="product.group_uom" options='{"no_open": True}'/>
                                    <field name="tax_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','&lt;&gt;','purchase')]"/>
                                    <field name="price_unit" string='Restaurant Price'/>
                                    <field name='markup'/>
                                    <field name='service_charge'/>
                                    <field name='commission'/>
                                    <field name="discount" groups="sale.group_discount_per_so_line"/>
                                    <field name="price_subtotal" string='Tour Operator Price'/>
                                    <button name="%(mail.action_email_compose_message_wizard)d" states="draft,confirmed" string="Send By Mail" type="action" icon="terp-mail-"/>
                                </tree>
                            </field>
                </field>
                
              </field>
         </record>
         
<!--  ================= 
	   Sales: Venues
      =================  
--> 

    <record model="ir.actions.act_window" id="action_ccsales_venue">
        <field name="name">Sales - Venue</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">tree,graph,form,calendar</field>
        <field name="domain">[('service_type','=','venue')]</field>
        <field name="view_id" eval="False"/>
        <field name="search_view_id" ref="sale.view_sales_order_filter"/>
       <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a quotation that can be converted into a sales
                order.
              </p><p>
                OpenERP will help you efficiently handle the complete sales flow:
                quotation, sales order, delivery, invoicing and payment.
              </p>
            </field>
    </record>

    <record model="ir.actions.act_window.view" id="action_ccsales_sales_tree">
        <field name="sequence" eval="1"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="sale.view_order_tree"/>
        <field name="act_window_id" ref="action_ccsales_venue"/>
    </record>

    <record model="ir.actions.act_window.view" id="action_cclead_sales_form">
        <field name="sequence" eval="2"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="sale.view_order_form"/>
        <field name="act_window_id" ref="action_ccsales_venue"/>
    </record>
    
<!--      <menuitem  action="action_ccsales_venue" id="menu_sales_venues" name="Venues" parent="menu_cc_sales" sequence="1" groups='Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo'/> -->

 
<!--  ====================== 
	   Sales: Afternoon Tea
      ====================== -->
 

   <record model="ir.actions.act_window" id="action_ccsales_ntea">
        <field name="name">Sales - Afternoon Tea</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">tree,graph,form,calendar</field>
        <field name="domain">[('service_type','=','noontea')]</field>
        <field name="view_id" eval="False"/>
        <field name="search_view_id" ref="sale.view_sales_order_filter"/>
       <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a quotation that can be converted into a sales
                order.
              </p><p>
                OpenERP will help you efficiently handle the complete sales flow:
                quotation, sales order, delivery, invoicing and payment.
              </p>
            </field>
    </record>

    <record model="ir.actions.act_window.view" id="action_ccsales_sales_ntea_tree">
        <field name="sequence" eval="1"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="sale.view_order_tree"/>
        <field name="act_window_id" ref="action_ccsales_ntea"/>
    </record>

    <record model="ir.actions.act_window.view" id="action_cclead_sales_ntea_form">
        <field name="sequence" eval="2"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="sale.view_order_form"/>
        <field name="act_window_id" ref="action_ccsales_ntea"/>
    </record>
    
<!--     <menuitem  action="action_ccsales_ntea" id="menu_sales_ntea" name="Afternoon Tea" parent="menu_cc_sales" sequence="2" groups='Trabacus_Capitalcentric.cc_admin,Trabacus_Capitalcentric.cc_bo'/> -->

<!--  ====================== 
	   Overridden: Product
      ====================== --> 
 <record id="view_cc_product_form" model="ir.ui.view">
	            <field name="name">view_cc_product_form</field>
	            <field name="model">product.product</field>
	            <field name="inherit_id" ref="account.product_normal_form_view"/>
	            <field name="arch" type="xml">    
	    		
	    		<page string="Accounting" groups="account.group_account_invoice" position="attributes">
	    			<attribute name="groups">Trabacus_Capitalcentric.cc_admin</attribute>
	    		</page>
	    		</field>
	    </record>        
         
      </data>
   </openerp>
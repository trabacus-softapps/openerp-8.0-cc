<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        
        
<!--	^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
       			Invoice: Option (form)
  		^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->
        <record id="view_invoice_option_form" model="ir.ui.view">
            <field name="name">view.invoice.option.form</field>
            <field name="model">tr.invoice.option</field>
            <field name="arch" type="xml">
                <form string="Create Option">
                    <group colspan="1" col="2">
                        <field name="name" required="1" colspan="8" />
                    </group>
                    <notebook colspan="4">
                        <page string="Flights">
                            <field name="flight_ids" mode="tree" nolabel="1" 
                                colspan="8" context="{'type': context.get('type'), 'travel_type':context.get('travel_type')}" />
                        </page>
                        <page string="Hotels">
                            <field name="hotel_ids" mode="tree" nolabel="1" context="{'type': context.get('type'), 'travel_type':context.get('travel_type')}">
                                <tree string="Hotel">
                                    <field name="tpartner_id"/>
                                    <field name="name"/>
                                    <field name="a_rate"  string="Per Adult (S)"/>
                                    <field name="tn_rate" string="Per Adult (D)"/>
                                    <field name="t3_rate" string="Per Adult (T)"/>
                                    <field name="e_rate"  string="Per Ex. Person"/>
                                    <field name="c_rate"  string="Per CWB"/>
                                    <field name="cn_rate" string="Per CNB"/>
                                    <field name="i_rate"  string="Per Infant"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Transfers">
                            <field name="car_ids" mode="tree" nolabel="1"
                                colspan="8" context="{'type': type, 'travel_type':travel_type , 
                                'ad_cnt': context.get('ad_cnt'), 'ext_cnt': context.get('ext_cnt'), 
                                'ch_cnt': context.get('ch_cnt'), 'inf_cnt': context.get('inf_cnt')}"/>
                        </page>
                        <page string="Cruise">
                            <field name="cruise_ids" mode="tree" nolabel="1"
                                colspan="8" context="{'type': context.get('type'), 'travel_type':context.get('travel_type')}">
                                <tree string="Cruise">
                                    <field name="tpartner_id"/>
                                    <field name="name"/>
                                    <field name="a_subtotal" string="Per Adult"/>
                                    <field name="e_subtotal" string="Per Ex. Person"/>
                                    <field name="c_subtotal" string="Per Child"/>
                                    <field name="i_subtotal" string="Per Infant"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Activities">
                            <field name="activity_ids" mode="tree" nolabel="1"
                                colspan="8" context="{'type': context.get('type'), 'travel_type':context.get('travel_type')}">
                                <tree string="Activities">
                                    <field name="tpartner_id"/>
                                    <field name="name"/>
                                    <field name="a_subtotal" string="Per Adult"/>
                                    <field name="c_subtotal" string="Per Child"/>
                                    <field name="i_subtotal" string="Per Infant"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Addons">
                            <field name="addon_ids" mode="tree" nolabel="1"
                                colspan="8" context="{'type': context.get('type'), 'travel_type':context.get('travel_type')}">
                                <tree string="Addons">
                                    <field name="tpartner_id"/>
                                    <field name="name"/>
                                    <field name="a_subtotal" string="Per Adult"/>
                                    <field name="c_subtotal" string="Per Child"/>
                                    <field name="i_subtotal" string="Per Infant"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Visa">
                            <field name="visa_ids" mode="tree" nolabel="1"
                                colspan="8" context="{'type': context.get('type'), 'travel_type':context.get('travel_type')}">
                                <tree string="Visa">
                                    <field name="tpartner_id"/>
                                    <field name="name"/>
                                    <field name="a_rate" string="Per Adult"/>
                                    <field name="c_rate" string="Per Child"/>
                                    <field name="i_rate" string="Per Infant"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Insurance">
                            <field name="insurance_ids" mode="tree" nolabel="1"
                                colspan="8" context="{'type': context.get('type'), 'travel_type':context.get('travel_type')}"/>
                        </page>
                        <page string="Summary">
                            <field name="opt_lines" mode="tree" nolabel="1" colspan="8">
                                <tree string="Summary" editable="bottom">
                                    <field name="type"/>
                                    <field name="flight_cost"/>
                                    <field name="hotel_cost"/>
                                    <field name="car_cost"/>
                                    <field name="cruise_cost"/>
                                    <field name="activity_cost"/>
                                    <field name="addon_cost"/>
                                    <field name="visa_cost"/>
                                    <field name="ins_cost"/>
                                    <field name="add_markup"/>
                                    <field name="add_servicechrg"/>
                                    <field name="add_discount"/>
                                    <field name="opt_total"  widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="currency_id" invisible="0" />
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>
                    
                    

<!--	^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
       			Invoice: Holiday Package 
  		^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->
        <record id="view_invoice_form_pack" model="ir.ui.view">
            <field name="name">view.invoice.form.pack</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Invoice" version="7.0">
                    <header>
                        <button name="button_order_confirm" states="quotation"
                            string="Confirm Order" type="object" class="oe_highlight"
                            groups="base.group_user"/>
                        <button name="action_invoice_sent" type="object" string="Send by Email"
                            attrs="{'invisible':['|',('sent','=',True), ('state', '=', 'quotation')]}"
                            groups="base.group_user"/>
                        <button name="action_invoice_sent" type="object" string="Send by Email"
                            attrs="{'invisible':['|',('sent','=',False), ('state', '=', 'quotation')]}"
                            groups="base.group_user"/>
                        <button name="print_invoice" string="Print" type="object"
                            attrs="{'invisible':['|',('sent','=',True), ('state', 'in', ('quotation','draft'))]}"
                            groups="base.group_user"/>
                        <button name="print_invoice" string="Print Invoice" type="object"
                            attrs="{'invisible':['|',('sent','=',False), ('state', 'in', ('quotation','draft'))]}"
                            groups="base.group_user"/>
                        <button name="print_voucher" string="Print Voucher" type="object"
                            attrs="{'invisible':['|',('state', 'not in', ('open','paid')),('travel_type','in',('dom_flight','int_flight','visa','insurance','railway','cruise'))]}"
                            groups="base.group_user"/>
                        <button name="invoice_open" states="draft" string="Validate"
                            class="oe_highlight" groups="base.group_user"
                            invisible="context.get('sale_view',False)"/>
                        <button name="invoice_open" states="proforma2" string="Validate"
                            groups="base.group_user" invisible="context.get('sale_view',False)"/>
                        <button name="invoice_pay_customer" type="object" string="Register Payment"
                            attrs="{'invisible': ['|', ('state','!=','open'), ('sent','=',True)]}"
                            invisible="context.get('sale_view',False)"/>
                        <button name="invoice_pay_customer" type="object" string="Register Payment"
                            attrs="{'invisible': ['|', ('state','!=','open'), ('sent','=',False)]}"
                            invisible="context.get('sale_view',False)" class="oe_highlight"/>
                        <button name="%(account.action_account_invoice_refund)d" type="action"
                            string="Refund Invoice" context="{'invoice_id':active_id}"
                            attrs="{'invisible': ['|', ('type','=','out_refund'), ('state','in',('quotation','draft','order_cancel','cancel'))]}"
                            groups="base.group_user"/>
                        <button name="invoice_cancel" states="draft,proforma2,open"
                            string="Cancel Invoice" invisible="context.get('sale_view',False)"/>
                        <button name="action_cancel_draft" states="cancel" string="Reset to Draft"
                            type="object" groups="base.group_user"/>
                        <button name="button_order_cancel" states="quotation,draft"
                            string="Cancel Order" type="object"/>
                        <button name="button_set_quotation" states="order_cancel"
                            string="Reset to New" type="object"/>
                        <button name="%(account.action_account_state_open)d" type="action"
                            string="Re-Open" groups="account.group_account_invoice"
                            attrs="{'invisible':['|', ('state','&lt;&gt;','paid'), ('reconciled', '=', True)]}"
                            help="This button only appears when the state of the invoice is 'paid' (showing that it has been fully reconciled) and auto-computed boolean 'reconciled' is False (depicting that it's not the case anymore). In other words, the invoice has been dereconciled and it does not fit anymore the 'paid' state. You should press this button to re-open it and let it continue its normal process after having resolved the eventual exceptions it may have created."/>
                        <field name="state" widget="statusbar" nolabel="1"
                            statusbar_visible="quotation,draft,open,paid"
                            statusbar_colors='{"proforma":"blue","proforma2":"blue"}'/>
                    </header>
                    <sheet string="Invoice">
                        <h1>
                            <label string="Quotation "
                                attrs="{'invisible': ['|',('state','not in',('quotation',)), ('type','&lt;&gt;','out_invoice')]}"/>
                            <label string="Draft Invoice "
                                attrs="{'invisible': ['|',('state','not in',('draft',)), ('type','&lt;&gt;','out_invoice')]}"/>
                            <label string="Draft Credit Note "
                                attrs="{'invisible': ['|',('state','not in',('draft',)), ('type','&lt;&gt;','out_refund')]}"/>
                            <label string="Pro Forma Invoice "
                                attrs="{'invisible': [('state','not in',('proforma','proforma2'))]}"/>
                            <label string="Invoice "
                                attrs="{'invisible': ['|',('state','in',('draft','proforma','proforma2')), ('type','&lt;&gt;','out_invoice')]}"/>
                            <label string="Credit Note "
                                attrs="{'invisible': ['|',('state','in',('draft','proforma','proforma2')), ('type','&lt;&gt;','out_refund')]}"/>
                            <field name="number" readonly="1" class="oe_inline"/>
                        </h1>
                        <field name="type" invisible="1"/>
                        <field name="travel_type" invisible="1"/>
                        <group>
                            <group>
                                <group colspan="2" col="4">
                                    <field string="Customer" name="partner_id" required="1"
                                        on_change="onchange_partner_id(type,partner_id,date_invoice,payment_term, partner_bank_id,company_id)"
                                        groups="base.group_user"
                                        context="{'search_default_supplier':1, 'show_address': 1}"
                                        options='{"always_reload": True}'
                                        domain="[('customer', '=', True)]" colspan="3"/>
                                    <button name="button_update" icon="gtk-refresh" type="object"
                                        help="Update Customer Discount"
                                        attrs="{'invisible':[('type', 'not in', ('out_invoice'))]}"
                                    />
                                </group>
                                <field name="date_due"
                                    attrs="{'invisible': [('state','=','quotation')]}"/>
                                <field name="user_id"/>
                                <field name="consultant_id" domain="[('id','!=',1)]"/>
                                <field name="project_code"/>
                                <field name="auth_ref"/>
                                <field name="psr_date"
                                    attrs="{'invisible':[('travel_type', 'not in', ('dom_flight', 'int_flight'))]}"
                                />
                            </group>
                            <group>
                                <field name="lead_id" on_change="onchange_leadid(lead_id, context)"
                                    placeholder="Lead No..." context="{'showinfo':True}"/>
                                <field name="create_date" readonly="1" widget="date"/>
                                <field name="date_invoice"
                                    attrs="{'invisible': [('state','=','quotation')]}"
                                    on_change="onchange_invoicedate(date_invoice, context)"/>
                                <field name="journal_id" invisible="1"
                                    on_change="onchange_journal_id(journal_id, context)"
                                    widget="selection"/>
                                <field
                                    domain="[('company_id', '=', company_id),('type','=', 'receivable')]"
                                    name="account_id" groups="account.group_account_user"
                                    required="1"/>
                                <label for="currency_id"/>
                                <div>
                                    <field name="currency_id" class="oe_inline"/>
                                </div>
                                <field name="is_ticket" readonly="1"
                                    attrs="{'invisible':[('travel_type', 'not in', ('dom_flight', 'int_flight'))]}"/>
                                <field name="paxtype"/>
                                <field name="purpose"/>
                            </group>
                        </group>
                        <field name="sent" invisible="1"/>

                        <notebook colspan="4">
                            <page string="Information">

                                <group colspan="2" col="14">
                                    <label string="Adult (S)" class="trab_bold_css"/>
                                    <label string="Adult (D)" class="trab_bold_css"/>
                                    <label string="Adult (T)" class="trab_bold_css"/>
                                    <label string="Extra Person" class="trab_bold_css"/>
                                    <label string="CWB" class="trab_bold_css"/>
                                    <label string="CNB" class="trab_bold_css"/>
                                    <label string="Infant" class="trab_bold_css"/>
                                    <newline/>
                                    <field name="adult" nolabel="1"/>
                                    <field name="twin" nolabel="1"/>
                                    <field name="triple" nolabel="1"/>
                                    <field name="extra" nolabel="1"/>
                                    <field name="cwb" nolabel="1"/>
                                    <field name="cnb" nolabel="1"/>
                                    <field name="infant" nolabel="1"/>
                                </group>

                                <newline/>
                                <group colspan="2" col="4">
                                    <group colspan="2" col="3">
                                        <field name="pkdest_ids" mode="tree" nolabel="1">
                                            <tree string="Destination" editable="bottom">
                                                <field name="destination_id"/>
                                                <field name="no_nts"/>
                                            </tree>
                                        </field>
                                    </group>
                                    <group colspan="2" col="2">
                                        <label string="Start Date" class="trab_bold_css"/>
                                        <field name="start_date" nolabel="1"/><newline/>
                                        <label string="Option Confirmed" class="trab_bold_css"/>
                                        <field name="option_id" nolabel="1"/>
                                    </group>
                                </group>

                                <!--<group colspan="2" col="8">
                                    <field name="optsmry_ids" mode="tree" nolabel="1" colspan="8">
                                        <tree string="Summary" editable="bottom"> 
                                            <field name="type"/>
                                            <field name="s_flight"/>
                                            <field name="s_hotel"/>
                                            <field name="s_transfer"/>
                                            <field name="s_cruise"/>
                                            <field name="s_activity"/>
                                            <field name="s_addon"/>
                                            <field name="s_visa"/>
                                            <field name="s_ins"/>
                                        </tree>
                                    </field>
                                </group>-->

                                <group class="oe_subtotal_footer oe_right">
                                    <field name="amount_untaxed" widget="monetary"
                                        options="{'currency_field': 'currency_id'}"/>
                                    <div>
                                        <label for="amount_tax"/>
                                        <button name="button_reset_taxes"
                                            states="quotation,draft,proforma2" string="(update)"
                                            class="oe_link oe_edit_only" type="object"
                                            help="Recompute taxes and total"/>
                                    </div>
                                    <field name="amount_tax" nolabel="1" widget="monetary"
                                        options="{'currency_field': 'currency_id'}"/>
                                    <field name="amount_total" class="oe_subtotal_footer_separator"
                                        widget="monetary"
                                        options="{'currency_field': 'currency_id'}"/>
                                    <field name="residual" groups="account.group_account_user"
                                        widget="monetary"
                                        options="{'currency_field': 'currency_id'}"/>
                                    <field name="amount_profit" widget="monetary"
                                        options="{'currency_field': 'currency_id'}"/>
                                    <field name="reconciled" invisible="1"/>
                                </group>
                                <div style="width: 50%%">
                                    <field name="tax_line" readonly="1">
                                        <tree editable="bottom" string="Taxes">
                                            <field name="name"/>
                                            <field name="account_id"
                                                groups="account.group_account_user"/>
                                            <field name="base"
                                                on_change="base_change(base,parent.currency_id,parent.company_id,parent.date_invoice)"
                                                readonly="1"/>
                                            <field name="amount"
                                                on_change="amount_change(amount,parent.currency_id,parent.company_id,parent.date_invoice)"/>
                                            <field invisible="True" name="base_amount"/>
                                            <field invisible="True" name="tax_amount"/>
                                            <field name="factor_base" invisible="True"/>
                                            <field name="factor_tax" invisible="True"/>
                                        </tree>
                                    </field>
                                </div>
                                <group>
                                    <field name="payment_term" class="oe_inline"/>
                                </group>
                                <div class="oe_clear">
                                    <label for="comment"/>
                                </div>
                                <field name="comment" class="oe_inline"
                                    placeholder="Additional notes..."/>
                            </page>
                            <page string="Itinerary"> 
                            </page>
                            <page string="Options">
                                <field name="option_ids" mode="tree" nolabel="1" colspan="8"  
                                    context="{'type': type, 'travel_type':travel_type , 'ad_cnt': (adult + twin + triple), 'ext_cnt': (extra), 'ch_cnt': (cwb + cnb),'inf_cnt': (infant)}">
                                   <!-- <kanban>
                                        <field name="name"/>
                                        <templates>
                                            <t t-name="kanban-box">
                                                <div
                                                  class="oe_kanban_vignette oe_semantic_html_override">
                                                  <a type="open">
                                                  <t>
                                                  <img
                                                  t-att-src="kanban_image('account.invoice', 'pack_image', record.id.value)"
                                                  class="oe_kanban_image"/>
                                                  </t>
                                                  </a>
                                                  <div class="oe_kanban_details">
                                                  <h4 class="oe_partner_heading">
                                                  <a type="open">
                                                  <field name="name"/>
                                                  </a>
                                                  </h4>
                                                  </div>
                                                </div>
                                            </t>
                                        </templates>
                                    </kanban>-->
                                </field>
                            </page>

                            <page string="Passenger"> </page>

                            <page string="Extra Info" invisible="0">
                                <group col="4">
                                    <group>
                                        <!--<field name="company_id" on_change="onchange_company_id(company_id,partner_id,type,invoice_line,currency_id)" widget="selection" groups="base.group_multi_company"/> -->
                                        <field name="company_id" widget="selection"
                                            groups="base.group_multi_company"/>
                                        <field
                                            domain="[('partner_id.ref_companies', 'in', [company_id])]"
                                            name="partner_bank_id"/>
                                        <field name="period_id"
                                            domain="[('state', '=', 'draft'), ('company_id', '=', company_id)]"
                                            groups="account.group_account_manager"
                                            string="Accounting Period" placeholder="force period"/>
                                        <field name="edit_invoice" readonly="1"/>
                                    </group>
                                    <group>
                                        <field name="origin" groups="base.group_user"/>
                                        <field name="name" string="Customer Reference"/>
                                        <field name="move_id" groups="account.group_account_user"/>
                                    </group>
                                </group>
                            </page>
                            <page string="Payments" groups="base.group_user">
                                <field name="payment_ids">
                                    <tree string="Payments">
                                        <field name="date"/>
                                        <field name="move_id"/>
                                        <field name="ref"/>
                                        <field name="name"/>
                                        <field name="journal_id" groups="base.group_user"/>
                                        <field name="debit"/>
                                        <field name="credit"/>
                                        <field name="amount_currency"
                                            groups="base.group_multi_currency"/>
                                        <field name="currency_id" groups="base.group_multi_currency"
                                        />
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"
                            groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

    </data>
</openerp>
